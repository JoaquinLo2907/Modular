<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Weeducate</title>

  <!-- Iconic Fonts -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="../../vendors/iconic-fonts/font-awesome/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../../vendors/iconic-fonts/flat-icons/flaticon.css">

  <!-- DataTables CSS -->
  <link rel="stylesheet" href="../../assets/css/datatables.min.css">

  <!-- Bootstrap core CSS -->
  <link href="../../assets/css/bootstrap.min.css" rel="stylesheet">
  <!-- jQuery UI -->
  <link href="../../assets/css/jquery-ui.min.css" rel="stylesheet">
  <!-- Page Specific CSS (Slick Slider) -->
  <link href="../../assets/css/slick.css" rel="stylesheet">
  <!-- Weeducate styles -->
  <link href="../../assets/css/style.css" rel="stylesheet">

  <link rel="icon" type="image/png" sizes="32x32" href="../../assets/img/weicon/weicon.ico">
</head>

<body class="ms-body ms-aside-left-open ms-primary-theme ms-has-quickbar">
  <!-- … Sidebar & Navbar code … -->

  <main class="body-content">
    <div class="ms-content-wrapper">
      <div class="row">
        <div class="col-lg-12">
          <div class="ms-panel">
            <!-- HEADER: selector de periodo y botones -->
            <div class="ms-panel-header d-flex justify-content-between align-items-center">
              <div class="d-flex align-items-center">
                <h6 class="me-3 mb-0">Calificaciones de Estudiantes</h6>
                <select id="sel_periodo" class="form-select form-select-sm me-2"></select>
                <button id="btnNuevoPeriodo" class="btn btn-outline-secondary btn-sm me-2">
                  <i class="fas fa-calendar-plus"></i>
                </button>
                <button id="btnAsignarMateria" class="btn btn-primary btn-sm">
                  <i class="fas fa-plus"></i> Asignar Materia
                </button>
              </div>
            </div>
            <!-- /HEADER -->

            <div class="ms-panel-body">
              <div class="table-responsive">
                <table id="data-table-calificaciones" class="table table-striped table-bordered w-100">
                  <thead>
                    <tr>
                      <th>Alumno</th>
                      <th>Materia</th>
                      <th>Calificación</th>
                      <th>Periodo</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody><!-- DataTables inyecta las filas --></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal: Asignar Materia -->
        <div id="modalAsignar" class="modal fade" tabindex="-1">
          <div class="modal-dialog">
            <form id="formAsignar" class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Asignar Materia</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
              </div>
              <div class="modal-body">
                <div class="mb-3">
                  <label>Estudiante</label>
                  <select id="asig_estudiante" name="estudiante_id" class="form-select"></select>
                </div>
                <div class="mb-3">
                  <label>Materia</label>
                  <select id="asig_materia" name="materia_id" class="form-select"></select>
                </div>
                <!-- hidden para enviar el periodo -->
                <input type="hidden" name="periodo_id" id="asig_periodo_id">
              </div>
              <div class="modal-footer">
                <button type="submit" class="btn btn-primary">Asignar</button>
              </div>
            </form>
          </div>
        </div>

        <!-- Modal: Editar Calificación -->
        <div id="modalEditar" class="modal fade" tabindex="-1">
          <div class="modal-dialog">
            <form id="formEditar" class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Editar Calificación</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
              </div>
              <div class="modal-body">
                <div class="mb-3">
                  <label>Materia</label>
                  <input type="text" id="edt_materia" class="form-control" readonly>
                </div>
                <div class="mb-3">
                  <label>Calificación</label>
                  <input type="number" id="edt_calificacion" name="calificacion" class="form-control"
                         min="0" max="10" step="0.01" required>
                </div>
                <input type="hidden" name="calificacion_id" id="edt_calif_id">
              </div>
              <div class="modal-footer">
                <button type="submit" class="btn btn-success">Guardar</button>
              </div>
            </form>
          </div>
        </div>

        <!-- Modal: Nuevo Período -->
        <div id="modalPeriodo" class="modal fade" tabindex="-1">
          <div class="modal-dialog">
            <form id="formPeriodo" class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Crear Período</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
              </div>
              <div class="modal-body">
                <div class="mb-2">
                  <label>Nombre</label>
                  <input name="nombre" class="form-control" placeholder="Ej. 2025-A" required>
                </div>
                <div class="mb-2">
                  <label>Fecha inicio</label>
                  <input name="fecha_inicio" type="date" class="form-control" required>
                </div>
                <div class="mb-2">
                  <label>Fecha fin</label>
                  <input name="fecha_fin" type="date" class="form-control" required>
                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btn-success">Crear</button>
              </div>
            </form>
          </div>
        </div>

      </div>
    </div>
  </main>

  <!-- Scripts globales -->
  <script src="../../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../../assets/js/popper.min.js"></script>
  <script src="../../assets/js/bootstrap.min.js"></script>
  <script src="../../assets/js/perfect-scrollbar.js"></script>
  <script src="../../assets/js/jquery-ui.min.js"></script>

  <!-- DataTables -->
  <script src="../../assets/js/datatables.min.js"></script>
  <!-- Tu script de carga (debe ir después de datatables.min.js) -->
  <script src="../scripts/cargarCalificaciones.js"></script>

  <!-- Otros scripts de la página -->
  <script src="../../assets/js/slick.min.js"></script>
  <script src="../../assets/js/moment.js"></script>
  <script src="../../assets/js/jquery.webticker.min.js"></script>
  <script src="../../assets/js/framework.js"></script>
  <script src="../../assets/js/settings.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="../scripts/ImportarEstudiantes.js" defer></script>
  <script src="../scripts/alertaImportacionAlumnos.js" defer></script>
</body>
</html>
